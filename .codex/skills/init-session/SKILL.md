---
name: init-session
description: 在新会话开始时完成项目上下文初始化，快速建立“当前代码状态 + 历史背景 + 风险点”认知。用于用户要求“初始化session”“先熟悉项目”“读取README和提交历史”“给我当前项目概览”等场景；重点读取 README、doc 引导文档与最近 commit，并输出可执行的启动摘要。
---

# Init Session

按固定顺序完成初始化，确保后续开发不遗漏背景信息。

## 1) 获取仓库快照

- 先获取当前分支与工作区状态：
  - `git status --short --branch`
- 读取最近提交（默认 20 条）：
  - `git log --oneline --decorate -n 20`
- 若存在未提交改动，在摘要中明确标注“已存在本地改动”，避免误判。

## 2) 读取项目文档（按优先级）

按以下顺序读取，先当前事实、再历史背景：

1. `README.md`
2. `doc/README.md`
3. `doc/session-quickstart.md`
4. `doc/archive/` 中与当前需求最相关的 1~2 篇历史文档（仅在需要追溯方案背景时读取）

控制上下文：不要一次性加载全部 archive 文档。

## 3) 产出初始化摘要

输出时保持结构固定，便于后续 session 复用：

- 当前分支与工作区状态
- 最近关键提交（3~6 条）及各自影响范围
- 当前系统形态（例如 plan-only / 关键入口文件 / 主要命令）
- 关键配置项（尤其 `.env` 中策略参数）
- 已知风险与注意事项
- 建议的下一步动作（1~3 条）

## 4) 信息不足时提问

若初始化摘要无法支撑当前任务，优先提 1~2 个澄清问题，例如：

- 这次迭代目标是“修复问题”还是“新增功能”？
- 是否只关注某个模块（如 `assistant_app/agent.py`）？
- 是否需要同步输出待办优先级和执行顺序？

## 5) 输出风格约束

- 简洁、结论优先；避免堆砌长段背景复述。
- 只陈述当前仓库可验证的事实，不猜测未确认信息。
- 涉及路径时给出可点击文件路径（必要时附行号）。

## 快速触发示例

- “初始化session”
- “先帮我读 README 和最近提交，给个项目现状”
- “我刚回来，先做一轮 session bootstrapping”
